<div class="container mt-4" *ngIf="model && model.angajati">
    <div class="card">
        <div class="card-header">
            <h3>Profilul meu</h3>
        </div>
        <div class="card-body">
            <form (ngSubmit)="onSubmit()" #editForm="ngForm">
                <!-- Email display (read-only here, changed via separate section) -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <label class="form-label">Email Curent</label>
                        <input type="text"
                               class="form-control"
                               [value]="model.email"
                               readonly>
                    </div>
                </div>

                <!-- Email change section -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="mb-3">Schimbare Email</h5>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="newEmail" class="form-label">Email Nou</label>
                            <input type="email"
                                   id="newEmail"
                                   class="form-control"
                                   [(ngModel)]="emailChangeData.newEmail"
                                   name="newEmail">
                        </div>
                        <div class="mb-3">
                            <label for="currentPasswordForEmail" class="form-label">Parola Curentă (pentru schimbare email)</label>
                            <input type="password"
                                   id="currentPasswordForEmail"
                                   class="form-control"
                                   [(ngModel)]="emailChangeData.currentPassword"
                                   name="currentPasswordForEmail">
                        </div>
                    </div>
                </div>


                <!-- Password change section -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="mb-3">Schimbare Parolă</h5>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="oldPassword" class="form-label">Parola Veche</label>
                            <input type="password"
                                   id="oldPassword"
                                   class="form-control"
                                   [(ngModel)]="passwordData.oldPassword"
                                   name="oldPassword">
                        </div>
                        <div class="mb-3">
                            <label for="newPassword" class="form-label">Parola Nouă</label>
                            <input type="password"
                                   id="newPassword"
                                   class="form-control"
                                   [(ngModel)]="passwordData.newPassword"
                                   name="newPassword">
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirmă Parola Nouă</label>
                            <input type="password"
                                   id="confirmPassword"
                                   class="form-control"
                                   [(ngModel)]="passwordData.confirmPassword"
                                   name="confirmPassword">
                        </div>
                    </div>
                </div>

                <!-- Read-only information -->
                <div class="row">
                    <div class="col-md-6">
                        <h5 class="mb-3">Informații Utilizator</h5>
                        <p><strong>Id_utilizator:</strong> {{ model.id_utilizator }}</p>
                        <!-- <p><strong>Email:</strong> {{ model.email }}</p> -->
                        <p><strong>Rol:</strong> {{ model.rol }}</p>
                        <p><strong>Data creare cont:</strong> {{ model.data_creare | date:'medium' }}</p>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-12">
                        <h5 class="mb-3">Date Angajat</h5>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Prenume:</strong> {{ model.angajati.prenume }}</p>
                        <p><strong>Nume:</strong> {{ model.angajati.nume }}</p>
                        <p><strong>Nr. Legitimație:</strong> {{ model.angajati.nr_legitimatie }}</p>
                        <p><strong>Cod Bluetooth:</strong> {{ model.angajati.cod_bluetooth }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>ID Smartphone:</strong> {{ model.angajati.identificator_smartphone }}</p>
                        <p><strong>Nr. Mașină:</strong> {{ model.angajati.nr_masina }}</p>
                        <p><strong>Acces Activ:</strong> {{ model.angajati.acces_activ ? 'Da' : 'Nu' }}</p>
                        <p><strong>Badge Acordat De:</strong> {{ model.angajati.badge_acordat_de }}</p>
                    </div>
                </div>

                <div class="d-flex gap-2 mt-4">
                    <button type="submit"
                            class="btn btn-primary"
                            [disabled]="(passwordData.newPassword && passwordData.newPassword !== passwordData.confirmPassword) || (emailChangeData.newEmail && !emailChangeData.currentPassword)">
                        Salvează Modificările
                    </button>
                    <button type="button"
                            class="btn btn-secondary"
                            (click)="onCancel()">
                        Anulează
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

